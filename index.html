<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Escape Game Magique</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Uncial+Antiqua&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Uncial Antiqua', cursive;
      background: url('https://www.transparenttextures.com/patterns/parchment.png');
      color: #f5f5dc;
      text-shadow: 1px 1px 3px #000;
      margin: 0;
      padding: 0;
    }
    #intro, #game, #overlay {
      max-width: 900px;
      margin: auto;
      padding: 30px;
    }
    #intro {
      background: rgba(0,0,0,0.8);
      margin-top: 60px;
      border-radius: 15px;
      box-shadow: 0 0 30px #6f42c1;
      text-align: center;
    }
    #game {
      display: none;
      background: rgba(0,0,0,0.7);
      border-radius: 20px;
      box-shadow: 0 0 30px #d4af37;
    }
    .card {
      border: 2px solid #b8860b;
      padding: 20px;
      margin: 15px 0;
      background: rgba(30,30,30,0.9);
      border-radius: 12px;
      box-shadow: 0 0 15px #d4af37;
    }
    #overlay {
      display: none;
      text-align: center;
    }
    button {
      padding: 10px 20px;
      margin-top: 15px;
      background: #6f42c1;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Cinzel', serif;
      font-size: 1.1em;
      box-shadow: 0 0 10px #000;
    }
    button:hover {
      background: #d4af37;
      color: black;
    }
    #timer {
      font-size: 1.4em;
      text-align: right;
      margin-bottom: 20px;
      color: #ffd700;
    }
  </style>
</head>
<body>

<div id="intro">
  <h1>‚ú® L‚ÄôAcad√©mie des Arcanes ‚ú®</h1>
  <p>Une ombre plane sur l‚ÄôAcad√©mie‚Ä¶ La magie noire menace d‚Äôengloutir le monde.</p>
  <p>Votre mission : r√©soudre les √©nigmes des Anciens avant que le sablier ne s‚Äô√©coule.</p>
  <p>Si vous √©chouez, l‚ÄôAcad√©mie sera perdue √† jamais...</p>
  <button onclick="startGame()">Commencer l‚Äôaventure</button>
</div>

<div id="game">
  <div id="timer">Temps restant : 10:00</div>

  <div class="card">
    <h2>√ânigme 1 : Suite Arcanique</h2>
    <p>2, 4, 8, 16, ‚Ä¶ ?</p>
    <input id="q1"><button onclick="checkAnswer(1)">Valider</button>
  </div>

  <div class="card">
    <h2>√ânigme 2 : Crypte Chiffr√©e</h2>
    <p>ROT13 ‚Üí ‚ÄúCebtenzz‚Äù</p>
    <input id="q2"><button onclick="checkAnswer(2)">Valider</button>
  </div>

  <div class="card">
    <h2>√ânigme 3 : Pi√®ge de Logique</h2>
    <p>A : "Je mens toujours"<br>B : "A ment"<br>C : "B dit vrai"<br>Qui dit vrai ?</p>
    <input id="q3"><button onclick="checkAnswer(3)">Valider</button>
  </div>

  <div class="card">
    <h2>√ânigme 4 : Les Runes</h2>
    <p>Le mot cach√© est ‚ÄúURYYB‚Äù (ROT13). Quel est-il ?</p>
    <input id="q4"><button onclick="checkAnswer(4)">Valider</button>
  </div>

  <div class="card">
    <h2>√ânigme 5 : √âtoiles Arcanes</h2>
    <p>Combien de branches a un pentagramme ?</p>
    <input id="q5"><button onclick="checkAnswer(5)">Valider</button>
  </div>

  <div class="card">
    <h2>√ânigme 6 : Potion Temporelle</h2>
    <p>Si hier √©tait demain, aujourd‚Äôhui serait‚Ä¶ ?</p>
    <input id="q6"><button onclick="checkAnswer(6)">Valider</button>
  </div>

  <div class="card">
    <h2>√ânigme 7 : Cadenas des Ombres</h2>
    <p>13 + 27 + 45 = ?</p>
    <input id="q7"><button onclick="checkAnswer(7)">Valider</button>
  </div>

  <div class="card">
    <h2>√ânigme 8 : Le Sphinx</h2>
    <p>Je parle sans bouche et j‚Äôentends sans oreilles. Qui suis-je ?</p>
    <input id="q8"><button onclick="checkAnswer(8)">Valider</button>
  </div>

</div>

<div id="overlay"></div>

<script>
let timerInterval;
let indiceInterval;
let tempsRestant = 600; // 10 minutes
let score = 0;
let solved = 0;
const total = 8;

// r√©ponses
const answers = {
  1:"32", 2:"program", 3:"C", 4:"hello", 
  5:"5", 6:"lundi", 7:"85", 8:"echo"
};

function startGame(){
  document.getElementById("intro").style.display="none";
  document.getElementById("game").style.display="block";
  startTimer();
}

function startTimer(){
  timerInterval = setInterval(()=>{
    tempsRestant--;
    document.getElementById("timer").innerText="Temps restant : " + formatTime(tempsRestant);
    if(tempsRestant <= 0){
      gameOver(false);
    }
  },1000);

  // indices al√©atoires toutes 90-150s
  indiceInterval = setInterval(()=>{
    proposerIndiceAleatoire();
  }, Math.floor(Math.random()*60000)+90000);
}

function formatTime(s){
  let m=Math.floor(s/60), sec=s%60;
  return m+":"+(sec<10?"0":"")+sec;
}

function stopGame(){
  clearInterval(timerInterval);
  clearInterval(indiceInterval);
}

function checkAnswer(n){
  let val = document.getElementById("q"+n).value.trim().toLowerCase();
  if(val === answers[n].toLowerCase()){
    alert("‚úÖ Bonne r√©ponse !");
    score += 10;
    solved++;
    if(solved===total){ gameOver(true); }
  } else {
    alert("‚ùå Mauvaise r√©ponse !");
    score -= 2;
  }
}

function proposerIndiceAleatoire(){
  if(Math.random() < 0.6){
    if(confirm("‚ö° Un ancien esprit veut vous souffler un indice... Acceptez-vous ?")){
      afficherIndiceAleatoire();
      score -= 5;
    }
  }
}

function afficherIndiceAleatoire(){
  const indices = [
    "Les runes cachent un mot en ROT13...",
    "La suite double √† chaque √©tape...",
    "Le sphinx aime les √©chos...",
    "Ne compte pas seulement, observe la forme..."
  ];
  let indice = indices[Math.floor(Math.random()*indices.length)];
  alert("üí° Indice magique : " + indice);
}

function gameOver(victoire){
  stopGame();
  document.getElementById("game").style.display="none";
  let o=document.getElementById("overlay");
  o.style.display="block";
  o.innerHTML="";
  if(victoire){
    o.innerHTML=`
      <h1>üåü Victoire ! üåü</h1>
      <p>Les arcanes brillent de mille feux !<br>
      Vous avez sauv√© l‚ÄôAcad√©mie des Arcanes.<br>
      Votre nom sera grav√© dans le Livre des H√©ros.</p>
      <p>Score final : ${score}</p>
    `;
  } else {
    o.innerHTML=`
      <h1>‚ò†Ô∏è D√©faite‚Ä¶</h1>
      <p>La magie noire consume l‚ÄôAcad√©mie.<br>
      Les ombres gagnent, et votre √©chec restera √©ternel.</p>
      <p>Score final : ${score}</p>
    `;
  }
}
</script>
</body>
</html>
